name: Test reverse dependencies
on:
  pull_request:
  workflow_dispatch:
jobs:
  reverse_dependencies:
    name: Reverse dependency testing
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
            fetch-depth: 0

      - uses: martinfleis/reverse-dependency-testing@verbose
        with:
            package_name: libpysal
            ignore: >-
              fine
              tigernet
              cenpy
              autoesda
              region
            include: >-
              mapclassify
              libpysal
            whitelist: >-
              esda
            install: >-
              setuptools-scm
              py-opencv
              h3-py
              hdbscan
              pandana
              astropy
              geodatasets
            install_pip: >-
              opencv-contrib-python
              KDEpy
            installation_command: >-
              pip install .; python -c 'import libpysal; print(libpysal.examples.builtin_datasets.keys(); print(examples.get_path("columbus.shp")))'
            fail_on_failure: false
            verbose: true
            parallel: false
