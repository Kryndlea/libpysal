name: Test reverse dependencies
on:
  pull_request:
  workflow_dispatch:
jobs:
  reverse_dependencies:
    name: Reverse dependency testing
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
            fetch-depth: 0

      - uses: martinfleis/reverse-dependency-testing@verbose
        with:
            package_name: libpysal
            ignore: >-
              fine
              tigernet
              cenpy
              autoesda
              region
              greedy
              pysal
              mesa-geo
            include: >-
              mapclassify
            install: >-
              setuptools-scm
              py-opencv
              h3-py
              hdbscan
              pandana
              astropy
              geodatasets
              bokeh
              pulp
            install_pip: >-
              opencv-contrib-python
              KDEpy
            installation_command: >-
              pip install -e .; python -c 'import libpysal; libpysal.examples.fetch_all()'
            fail_on_failure: false
            verbose: true
            parallel: false
